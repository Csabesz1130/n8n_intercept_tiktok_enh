<!doctype html>
<html lang="hu">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Magyar Politikai TikTok Tartalom Gener√°tor</title>
  <style>
    :root{--w:900px;--primary:#2563eb;--success:#16a34a;--warning:#ea580c;--gray:#6b7280}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;max-width:var(--w);margin:30px auto;padding:0 20px;background:#f8fafc;color:#111;line-height:1.6}
    
    .header{text-align:center;margin-bottom:32px;padding:24px;background:linear-gradient(135deg,var(--primary),#1d4ed8);color:white;border-radius:16px}
    h1{margin:0 0 8px;font-size:28px;font-weight:700}
    .lead{margin:0;font-size:16px;opacity:0.9}
    
    .form-section{background:white;padding:24px;border-radius:12px;margin-bottom:24px;box-shadow:0 1px 3px rgba(0,0,0,0.1)}
    .section-title{font-size:18px;font-weight:600;margin:0 0 16px;color:var(--primary);border-bottom:2px solid #e2e8f0;padding-bottom:8px}
    
    label{display:block;margin:16px 0 6px;font-weight:600;color:#374151}
    input,select,textarea{width:100%;padding:12px 16px;border:2px solid #e5e7eb;border-radius:10px;background:#fff;font-size:14px;transition:border-color 0.2s}
    input:focus,select:focus,textarea:focus{outline:none;border-color:var(--primary)}
    textarea{resize:vertical;font-family:inherit}
    
    .row{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:16px}
    .row-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px}
    
    .checkbox-group{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:8px;margin-top:8px}
    .checkbox-item{display:flex;align-items:center;padding:8px 12px;background:#f8fafc;border:1px solid #e5e7eb;border-radius:6px;cursor:pointer;transition:all 0.2s}
    .checkbox-item:hover{background:#e0f2fe}
    .checkbox-item input{width:auto;margin-right:8px}
    
    .hashtag-suggestions{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
    .hashtag-btn{background:#e0f2fe;color:#0369a1;padding:6px 12px;border:none;border-radius:20px;font-size:12px;cursor:pointer;transition:all 0.2s}
    .hashtag-btn:hover{background:#0369a1;color:white}
    
    .actions{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-top:24px}
    button{padding:14px 20px;border:0;border-radius:10px;cursor:pointer;font-weight:600;font-size:16px;transition:all 0.2s}
    .primary{background:var(--primary);color:#fff}
    .primary:hover{background:#1d4ed8}
    .secondary{background:#f3f4f6;color:#374151}
    .secondary:hover{background:#e5e7eb}
    
    small{color:var(--gray);font-size:13px;margin-top:4px;display:block}
    .help-text{background:#eff6ff;border:1px solid #bfdbfe;padding:12px;border-radius:8px;margin-top:8px;font-size:13px;color:#1e40af}
    
    #msg{margin-top:16px;padding:12px;border-radius:8px;font-weight:600}
    .ok{background:#dcfce7;color:#166534;border:1px solid #bbf7d0}
    .pending{background:#dbeafe;color:#1e40af;border:1px solid #93c5fd}
    .err{background:#fee2e2;color:#dc2626;border:1px solid #fecaca}
    
    .advanced-toggle{cursor:pointer;color:var(--primary);text-decoration:underline;font-size:14px;margin:16px 0}
    .advanced-section{display:none;margin-top:16px;padding:16px;background:#f8fafc;border-radius:8px;border:1px solid #e5e7eb}
    .advanced-section.show{display:block}
    
    @media (max-width: 768px) {
      .row{grid-template-columns:1fr}
      .row-3{grid-template-columns:1fr}
      .actions{grid-template-columns:1fr}
      body{padding:0 16px}
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>Magyar Politikai TikTok Tartalom Gener√°tor</h1>
    <p class="lead">Intelligens tartalom aj√°nl√°sok magyar politikusoknak √©s szervezeteknek</p>
  </div>

  <form id="configForm"
        method="post"
        action="https://padavan1129.app.n8n.cloud/webhook/firestore-init"
        target="hidden_iframe">

    <!-- Organization Info Section -->
    <div class="form-section">
      <h2 class="section-title">Szervezet adatok</h2>
      
      <div class="row">
        <div>
          <label for="user_id">Felhaszn√°l√≥ azonos√≠t√≥</label>
          <input id="user_id" name="user_id" value="demo-user-1" required />
          <small>Egyedi azonos√≠t√≥ a be√°ll√≠t√°sok t√°rol√°s√°hoz</small>
        </div>
        <div>
          <label for="organization_type">Szervezet t√≠pusa</label>
          <select id="organization_type" name="organization_type" required>
            <option value="">V√°lassz t√≠pust...</option>
            <option value="ministry">Miniszt√©rium</option>
            <option value="party">Politikai p√°rt</option>
            <option value="agency">Korm√°nyhivatal</option>
            <option value="journalist">√öjs√°g√≠r√≥</option>
            <option value="ngo">Civil szervezet</option>
            <option value="consultant">Politikai tan√°csad√≥</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div>
          <label for="organization_name">Szervezet neve (opcion√°lis)</label>
          <input id="organization_name" name="organization_name" placeholder="pl. Bel√ºgyminiszt√©rium" />
        </div>
        <div>
          <label for="region">R√©gi√≥/Hat√≥k√∂r</label>
          <select id="region" name="region">
            <option value="budapest">Budapest</option>
            <option value="pest">Pest megye</option>
            <option value="videk">Vid√©k</option>
            <option value="nagyvarosok">Nagyv√°rosok</option>
            <option value="HU" selected>Eg√©sz Magyarorsz√°g</option>
            <option value="EU">EU kontextus</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Content Request Section -->
    <div class="form-section">
      <h2 class="section-title">Tartalom k√©r√©s</h2>
      
      <label for="natural_prompt">Term√©szetes nyelvi k√©r√©s</label>
      <textarea id="natural_prompt" name="natural_prompt" rows="3" 
                placeholder="P√©ld√°ul: Hogyan kommunik√°ljuk az √∫j eg√©szs√©g√ºgyi reformot a fiataloknak? Milyen TikTok tartalmakat k√©sz√≠ts√ºnk a v√°laszt√°si kamp√°nyhoz?"></textarea>
      <div class="help-text">
        üí° Tipp: √çrj term√©szetesen, mintha egy koll√©g√°dnak k√©rdezn√©l. Az AI meg√©rti a kontextust √©s relev√°ns √∂tleteket gener√°l.
      </div>

      <div class="row">
        <div>
          <label for="target_audience">Els≈ëdleges c√©lk√∂z√∂ns√©g</label>
          <select id="target_audience" name="target_audience">
            <option value="general">√Åltal√°nos k√∂z√∂ns√©g</option>
            <option value="fiatalok">18-35 √©vesek</option>
            <option value="kozepkor">36-55 √©vesek</option>
            <option value="idosek">55+ √©vesek</option>
            <option value="videk_lakossag">Vid√©ki lakoss√°g</option>
            <option value="varosi">V√°rosi lakoss√°g</option>
            <option value="egyetemistak">Egyetemist√°k</option>
            <option value="dolgozok">Dolgoz√≥ r√©teg</option>
          </select>
        </div>
        <div>
          <label for="content_tone">Kommunik√°ci√≥s st√≠lus</label>
          <select id="content_tone" name="content_tone">
            <option value="formal">Hivatalos, informat√≠v</option>
            <option value="friendly">Bar√°ts√°gos, szem√©lyes</option>
            <option value="energetic">Energikus, fiatalos</option>
            <option value="authoritative">Tekint√©lyes, szakmai</option>
            <option value="empathetic">Empatikus, meg√©rt≈ë</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Topics and Keywords Section -->
    <div class="form-section">
      <h2 class="section-title">T√©m√°k √©s kulcsszavak</h2>
      
      <label for="topics">F≈ë t√©m√°k / hashtagek</label>
      <textarea id="topics" name="topics" rows="2" placeholder="#eg√©szs√©g√ºgy #reform #fiatalok kamp√°ny oktat√°s"></textarea>
      <small>√çrd be a t√©m√°kat hashtagekkel (#) vagy kulcsszavakk√©nt. A rendszer automatikusan feldolgozza.</small>
      
      <div class="hashtag-suggestions">
        <span style="font-weight:600;margin-right:8px;">N√©pszer≈± magyar t√©m√°k:</span>
        <button type="button" class="hashtag-btn" onclick="addHashtag('#magyarorsz√°g')">#magyarorsz√°g</button>
        <button type="button" class="hashtag-btn" onclick="addHashtag('#budapest')">#budapest</button>
        <button type="button" class="hashtag-btn" onclick="addHashtag('#politika')">#politika</button>
        <button type="button" class="hashtag-btn" onclick="addHashtag('#gazdas√°g')">#gazdas√°g</button>
        <button type="button" class="hashtag-btn" onclick="addHashtag('#eg√©szs√©g√ºgy')">#eg√©szs√©g√ºgy</button>
        <button type="button" class="hashtag-btn" onclick="addHashtag('#oktat√°s')">#oktat√°s</button>
        <button type="button" class="hashtag-btn" onclick="addHashtag('#csal√°d')">#csal√°d</button>
        <button type="button" class="hashtag-btn" onclick="addHashtag('#eu')">#eu</button>
      </div>
    </div>

    <!-- Contact and Delivery Section -->
    <div class="form-section">
      <h2 class="section-title">Kapcsolat √©s k√©zbes√≠t√©s</h2>
      
      <label for="emails">E-mail c√≠mek (vessz≈ë vagy sz√≥k√∂z elv√°lasztva)</label>
      <input id="emails" name="emails" placeholder="sajtos@party.hu, kollegam@miniszterium.hu" required />
      <small>IDE √©rkezik meg a gener√°lt PDF riport az √∂tletekkel</small>
      
      <div class="row">
        <div>
          <label for="delivery_format">K√©zbes√≠t√©si form√°tum</label>
          <select id="delivery_format" name="delivery_format">
            <option value="pdf">PDF riport</option>
            <option value="email_html">HTML e-mail</option>
            <option value="both" selected>Mindkett≈ë</option>
          </select>
        </div>
        <div>
          <label for="run_now_sel">Futtat√°s</label>
          <select id="run_now_sel">
            <option value="0">Csak ment√©s</option>
            <option value="1" selected>Ment√©s √©s azonnali futtat√°s</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Advanced Options (Collapsible) -->
    <div class="advanced-toggle" onclick="toggleAdvanced()">
      ‚öôÔ∏è Speci√°lis be√°ll√≠t√°sok (opcion√°lis)
    </div>
    <div class="advanced-section" id="advanced-options">
      <div class="row">
        <div>
          <label for="exclude_topics">Ker√ºlend≈ë t√©m√°k</label>
          <input id="exclude_topics" name="exclude_topics" 
                 placeholder="pl. migr√°ci√≥, koronav√≠rus" />
          <small>Ezeket a t√©m√°kat ker√ºli a gener√°tor</small>
        </div>
        <div>
          <label for="priority_keywords">Priorit√°si kulcsszavak</label>
          <input id="priority_keywords" name="priority_keywords" 
                 placeholder="pl. innov√°ci√≥, digitaliz√°ci√≥" />
          <small>Ezeket a kulcsszavakat el≈ënyben r√©szes√≠ti</small>
        </div>
      </div>
      
      <div class="checkbox-group">
        <div class="checkbox-item">
          <input type="checkbox" id="use_trending" name="use_trending" checked>
          <label for="use_trending">Trending t√©m√°k bevon√°sa</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="regional_focus" name="regional_focus" checked>
          <label for="regional_focus">Region√°lis f√≥kusz</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="competitor_analysis" name="competitor_analysis">
          <label for="competitor_analysis">Versenyt√°rs elemz√©s</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="video_inspiration" name="video_inspiration" checked>
          <label for="video_inspiration">Vide√≥ inspir√°ci√≥k keres√©se</label>
        </div>
      </div>
    </div>

    <!-- Hidden fields -->
    <input type="hidden" id="run_now" name="run_now" value="1" />

    <!-- Action buttons -->
    <div class="actions">
      <button type="submit" class="secondary">üíæ Csak ment√©s</button>
      <button type="submit" class="primary" id="saveRun">üöÄ Ment√©s √©s riport gener√°l√°s</button>
    </div>

    <iframe name="hidden_iframe" id="hidden_iframe" style="display:none"></iframe>
  </form>

  <p id="msg"></p>

  <script>
    const form = document.getElementById('configForm');
    const iframe = document.getElementById('hidden_iframe');
    const msg = document.getElementById('msg');
    const runHidden = document.getElementById('run_now');
    const runSelect = document.getElementById('run_now_sel');
    const saveRunBtn = document.getElementById('saveRun');

    // Keep hidden run_now in sync with select
    runSelect.addEventListener('change', () => runHidden.value = runSelect.value);
    
    // Ensure second button always sets run_now=1
    saveRunBtn.addEventListener('click', () => { runHidden.value = '1'; });

    // First button sets run_now=0
    document.querySelector('.secondary').addEventListener('click', () => { runHidden.value = '0'; });

    form.addEventListener('submit', () => {
      msg.className = 'pending';
      msg.textContent = '‚è≥ Feldolgoz√°s folyamatban... Ez n√©h√°ny percet ig√©nybe vehet.';
      setTimeout(() => { runHidden.value = runSelect.value; }, 0);
    });

    // When n8n responds, iframe loads ‚Üí show success
    iframe.addEventListener('load', () => {
      msg.className = 'ok';
      msg.textContent = '‚úÖ Sikeresen elmentve! A riport hamarosan meg√©rkezik az e-mailbe.';
    });

    // Advanced options toggle
    function toggleAdvanced() {
      const section = document.getElementById('advanced-options');
      section.classList.toggle('show');
    }

    // Hashtag helper function
    function addHashtag(hashtag) {
      const topicsField = document.getElementById('topics');
      const current = topicsField.value;
      if (!current.includes(hashtag)) {
        topicsField.value = current ? current + ' ' + hashtag : hashtag;
      }
    }

    // Organization type change handler
    document.getElementById('organization_type').addEventListener('change', function() {
      const type = this.value;
      const nameField = document.getElementById('organization_name');
      const promptField = document.getElementById('natural_prompt');
      
      // Update placeholder based on organization type
      switch(type) {
        case 'ministry':
          nameField.placeholder = 'pl. Bel√ºgyminiszt√©rium, P√©nz√ºgyminiszt√©rium';
          promptField.placeholder = 'Hogyan kommunik√°ljuk a korm√°ny √∫j int√©zked√©s√©t a lakoss√°g fel√©?';
          break;
        case 'party':
          nameField.placeholder = 'pl. Fidesz, MSZP, DK';
          promptField.placeholder = 'Milyen kamp√°ny tartalmakat k√©sz√≠ts√ºnk a k√∂vetkez≈ë v√°laszt√°sokra?';
          break;
        case 'journalist':
          nameField.placeholder = 'pl. Index.hu, 444.hu';
          promptField.placeholder = 'Hogyan mutathatn√°nk be ezt a politikai t√©m√°t k√∂z√©rthet≈ëen?';
          break;
        default:
          nameField.placeholder = 'Szervezet teljes neve';
          promptField.placeholder = '√çrj le, milyen tartalmat szeretn√©l...';
      }
    });

    // Guard against test URL
    if (form.action.includes('/webhook-test/')) {
      msg.className = 'err';
      msg.textContent = '‚ö†Ô∏è Figyelem: a form most a TEST webhookra mutat. Cser√©ld Production URL-re!';
    }

    // Auto-expand textarea on input
    document.getElementById('natural_prompt').addEventListener('input', function() {
      this.style.height = 'auto';
      this.style.height = this.scrollHeight + 'px';
    });
  </script>

  <noscript>A bek√ºld√©s JavaScript n√©lk√ºl is m≈±k√∂dik, de kevesebb funkci√≥val.</noscript>
</body>
</html>
